{
  "id": "extend-mailbox",
  "name": "Extend Mailbox Quota",
  "description": "Increase user mailbox storage quota to accommodate growing email needs - like expanding a digital warehouse",
  "category": "Mailbox Management",
  "author": "NetToolkit Team",
  "version": "1.0.0",
  "script": "# Extend user mailbox quota - storage expansion spell\nConnect-ExchangeOnline -ShowProgress $false\ntry {\n    Set-Mailbox -Identity '{email}' -ProhibitSendQuota '{quota}GB' -ProhibitSendReceiveQuota '{quotaMax}GB'\n    Write-Output \"Mailbox quota extended for {email} - storage expanded to {quota}GB with max {quotaMax}GB\"\n    Write-Output \"âœ… Admin alchemy successful - mailbox expanded like admin ambitions!\"\n} catch {\n    Write-Error \"Quota expansion failed: $($_.Exception.Message)\"\n    throw\n} finally {\n    Disconnect-ExchangeOnline -Confirm:$false\n}",
  "parameters": [
    {
      "name": "email",
      "displayName": "User Email Address",
      "description": "Email address of the user whose mailbox quota needs expansion",
      "type": "Email",
      "required": true,
      "placeholder": "user@company.com",
      "helpText": "Enter the full email address of the user",
      "validationPattern": "^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$",
      "validationMessage": "Please enter a valid email address"
    },
    {
      "name": "quota",
      "displayName": "New Quota (GB)",
      "description": "New mailbox quota in gigabytes (storage limit before send restrictions)",
      "type": "Integer",
      "required": true,
      "defaultValue": 10,
      "minValue": 1,
      "maxValue": 100,
      "placeholder": "25",
      "helpText": "Quota should be reasonable - typically 5-50GB for most users"
    },
    {
      "name": "quotaMax",
      "displayName": "Maximum Quota (GB)",
      "description": "Maximum quota before send/receive is completely blocked",
      "type": "Integer",
      "required": true,
      "defaultValue": 15,
      "minValue": 2,
      "maxValue": 150,
      "placeholder": "30",
      "helpText": "Should be higher than regular quota - acts as safety buffer"
    }
  ],
  "requiredScopes": [
    "https://outlook.office365.com/Exchange.Manage"
  ],
  "prerequisites": [
    "Exchange Online PowerShell module installed",
    "Exchange Administrator role or higher",
    "User must exist in the organization"
  ],
  "estimatedDuration": "2-5 minutes",
  "complexity": "Basic",
  "tags": ["mailbox", "quota", "storage", "exchange", "email"],
  "iconName": "mail-quota",
  "helpUrl": "https://docs.microsoft.com/en-us/powershell/module/exchange/set-mailbox",
  "examples": [
    {
      "name": "Standard User Extension",
      "description": "Typical quota extension for a standard user",
      "parameters": {
        "email": "john.doe@company.com",
        "quota": 25,
        "quotaMax": 30
      },
      "expectedOutcome": "Mailbox quota increased to 25GB with 30GB maximum, user can receive more emails"
    },
    {
      "name": "Executive User Extension",
      "description": "Higher quota for executive or power user",
      "parameters": {
        "email": "ceo@company.com",
        "quota": 50,
        "quotaMax": 60
      },
      "expectedOutcome": "Premium storage allocation for executive user"
    }
  ]
}